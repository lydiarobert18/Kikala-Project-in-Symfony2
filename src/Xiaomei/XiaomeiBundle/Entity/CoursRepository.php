<?php

namespace Xiaomei\XiaomeiBundle\Entity;

use Doctrine\ORM\EntityRepository;
use \Datetime;

/**
 * CoursRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */

class CoursRepository extends EntityRepository
{
	// public function findHomeContents(){

	// 	$query = $this->getEntityManager()->createQuery('
	// 		SELECT cou, cat FROM XiaomeiXiaomeiBundle:Cours cou 
	// 		LEFT JOIN cou.category cat ');
 //         //order by limit by 
	// 	$contents = $query->getResult();

	// 	return $contents;
	// 	}

	public function findHomeContents($tri=null){

		 //$tri="dateCours"; 

		//$tri="nrPlaceReste"
		//$tri='categorie'
		//$tri='lieu'

		//utiliser formulaire get pour obtenir le valeur de $tri: 

		$query = $this->createQueryBuilder('c')
				->select('c, cat')	//hyper facile à oublier
						    
			    ->leftJoin('c.category', 'cat')			    
			    //->orderBy($tri,'DESC')
			    //->LIMIT BY 30 
			    ->getQuery();
         //order by limit by 
		$contents = $query->getResult();

		return $contents;
		}
		

	public function findFullSingleContent($id){

		$query = $this->createQueryBuilder('c')
				->select('c, cat')	//hyper facile à oublier
			    ->where('c.id = :id')
			    ->leftJoin('c.category', 'cat')
			    ->setParameter('id', $id)
			    ->getQuery();

		$content = $query->getSingleResult();

		return $content;
	}

}
